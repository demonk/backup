<html>
<head>
<title>Canvas Trees</title>
<script type="text/javascript" src="jquery-1.3.2.js"></script>
<script type="text/javascript" src="modernizr-1.0.js"></script>
<script type="text/javascript" src="SnakeCollection.js"></script>
<script type="text/javascript" src="Snake.js"></script>
<script type="text/javascript" src="RaindropCollection.js"></script>
<script type="text/javascript" src="raindrop.js"></script>
<script type="text/javascript" src="Footpaint.js"></script>
<script type="text/javascript">
			function randHex() {
				var num = Math.round(Math.random() * 255).toString(16);
				if (num.length == 1)
					num = "0"+num;
				return num;
			}
			
			jQuery(function() {
				if (Modernizr.canvas === true)
					jQuery("#canvas-warning").hide();
				
				// Convenience
				$canvas = jQuery("#canvas");
				canvas = $canvas[0];
				context = canvas.getContext("2d");
				
				$canvas_Cloud=jQuery("#canvas_cloud");
				canvas_Cloud=$canvas_Cloud[0];
				cloudContext=canvas_Cloud.getContext("2d");
					var dropimg=new Image();
					var cloudimg=new Image();
					cloudimg.src="cloud.png";
	dropimg.src="raindrop.png";
	cloudimg.onload=function()
	{
		cloudContext.drawImage(this,100,20);
	};
	
	
		dropimg.onload=function()
	{
		//cloudContext.drawImage(this,0,0);
		var dropCollection=new RaindropCollection(canvas_Cloud,this);
		for(var i=0;i<6;i++)
		{
			dropCollection.add(new Raindrop(canvas_Cloud));
		}
		setInterval(function(){dropCollection.next();},0);
	};
	
	
	$canvas_Foot=jQuery("#canvas_foot");
	canvas_foot=$canvas_Foot[0];
	var footpaint=new Image();
	footpaint.src="foot.png";
	footpaint.onload=function()
	{
		var footCollection=new FootCollection(canvas_foot,this);
		setInterval(function(){footCollection.slide();},100);
	};
	
				
				// Dimensions
				var width = $canvas.width();
				var height = $canvas.height();
				
				// Set actual canvas size to match css
				$canvas.attr("width", width);
				$canvas.attr("height", height);
				
				// Information
				jQuery("#info").html("Size: "+canvas.width+"x"+canvas.height);
				
				// Frame rate
				var frame = 0;
				
				// count of Snakes
				var n = 2+Math.random()*3;
				var initialRadius = width/30;
				snakes = new SnakeCollection();
				for (var i=0 ; i<n ; i++) {
					var snake = new Snake(canvas);
					snake.x = width/2 - initialRadius + i*initialRadius*2/n;
					snake.radius = initialRadius;
					snakes.add(snake);//collection of sanake
				}
				// Frame drawer
				var interval = setInterval(function() {
					snakes.next();
					
					frame++;
				}, 0);
				
				// fps
				var fpsInterval = setInterval(function() {
					jQuery("#fps").html(frame+" fps<br/>"+snakes.snakes.length+" branches running");
					frame = 0;
					if (snakes.snakes.length == 0) {
						clearInterval(interval);
						clearInterval(fpsInterval);
						var delay = 1500;
						jQuery("#info-container").fadeOut(1500, function(){
							jQuery("#info-container").html("Refresh for more delicious trees :)").fadeIn(delay, function() {
								setTimeout(function() {
									jQuery("#info-container").fadeOut(delay);
								}, delay*3)
							});
						});
					}
				}, 1000);
			});
		</script>
<style>
body {
	min-width:1300px;
	margin:0px;/* 				background-color: #abcdef; */
			}
#canvas {
	position:relative;
	left:616px;
	top:168px;
	/* 				width: 1500px; */
/* 				height: 800px; */
				width: 700px;
	height: 600px;/* 				border: 1px solid red; 
				border-bottom: 1px solid black;*/
			}
#canvas_cloud {
	position:absolute;
	top:0px;
	left:616px;
	width:	700px;
	height:768px;
}
#canvas_foot{
	position:absolute;
	
}
a {
	color: black;
}
</style>
</head>
<body background="index.png">
<canvas id="canvas_foot" width="666px" height="600px"></canvas>
<canvas id="canvas_cloud" width="700px" height="768px"></canvas>
<canvas id="canvas" ></canvas>
</body>
</html>